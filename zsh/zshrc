# vim: foldmethod=marker foldlevel=0

# Set up zplugin
# Load zplugin module
module_path+=( "${HOME}/.zplugin/mod-bin/zmodules/Src" )
# Sometimes this throws errors but it still works, so I just ignore them
zmodload zdharma/zplugin 2> /dev/null
source "${HOME}/.zplugin/mod-bin/zplugin.zsh"

# Base16-Shell Colors (this is done early to prevent flashing)
zplugin light chriskempson/base16-shell

# Source ~/.profile even if not running interactively
[[ -e "$HOME/.profile" ]] && source "$HOME/.profile"

# Add more completions
zplugin light zsh-users/zsh-completions

# Command specific autocompletions
zplugin snippet OMZ::plugins/pip/pip.plugin.zsh

# Easy extraction
zplugin snippet OMZ::plugins/extract/extract.plugin.zsh
# Make man pages colorful
zplugin snippet OMZ::plugins/colored-man-pages/colored-man-pages.plugin.zsh

# Oh-my-zsh
export ZSH="$HOME/.oh-my-zsh"
# Case-sensitive completion must be off. _ and - will be interchangeable.
HYPHEN_INSENSITIVE="true"
source $ZSH/oh-my-zsh.sh

# General
# Source broad configuration files
source ~/.bookmarks.zsh
source ~/.aliases
source ~/.functions

# Load completions
autoload -U compinit; compinit
# Completions for kitty
if command -v kitty > /dev/null; then
    kitty + complete setup zsh | source /dev/stdin
fi

# Vim keys
bindkey -v
# Reduce delay on <Esc> to 1 (not 0 so pure prompt can update)
export KEYTIMEOUT=1
# Easier history searching
bindkey '^N' down-line-or-beginning-search
bindkey '^P' up-line-or-beginning-search

# Pure prompt
zplugin light mafredri/zsh-async
zplugin light sindresorhus/pure
# Load prompt
prompt_pure_setup "$@"

# All new terminals automatically go to the last working directory (lwd does the same)
zplugin snippet OMZ::plugins/last-working-dir/last-working-dir.plugin.zsh

# Syntax highlighting (this must be done last)
zplugin light zsh-users/zsh-syntax-highlighting
